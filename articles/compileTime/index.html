<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="og:site_name" content="Cabulas"/><link rel="canonical" href="https://jjorgemoura.github.io/articles/compileTime"/><meta name="twitter:url" content="https://jjorgemoura.github.io/articles/compileTime"/><meta name="og:url" content="https://jjorgemoura.github.io/articles/compileTime"/><title>Xcode/Swift Compile Time | Cabulas</title><meta name="twitter:title" content="Xcode/Swift Compile Time | Cabulas"/><meta name="og:title" content="Xcode/Swift Compile Time | Cabulas"/><meta name="description" content="How to improve compile time."/><meta name="twitter:description" content="How to improve compile time."/><meta name="og:description" content="How to improve compile time."/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Cabulas"/></head><body class="item-page"><header><div class="wrapper"><a href="/" class="site-name">Cabulas</a><nav><ul><li><a href="/articles" class="selected">Articles</a></li><li><a href="/tips">Tips</a></li><li><a href="/posts">My posts</a></li></ul></nav></div></header><div class="wrapper"><article><div class="content"><h1>Xcode/Swift Compile Time</h1><p>I'm following <a href="https://useyourloaf.com/blog/slow-swift-compiler-performance/">this article</a>.</p><p>One important information is that the building times reported can be longer than the total compilation time. This is due to paralelization of the compilation.</p><blockquote><p>Yes â€“ many commands, especially compilation, are able to run in parallel with each other, so multicore machines will finish the build much faster than the time it took to run each of the commands.</p></blockquote><h2>Indentify some culprits</h2><h3>xcodebuild flags</h3><p>Run the command</p><pre><code>xcodebuild -workspace ArticleUIKit.xcworkspace -scheme ArticleUIKit clean build OTHER_SWIFT_FLAGS="-Xfrontend -debug-time-function-bodies" | grep .[0-9]ms | grep -v ^0.[0-9]ms | sort -nr &gt; culprits.txt
</code></pre><p>note: the command is not 100%, several duplicated lines.</p><h3>Xcode flags</h3><p>Flags we can use to identify compilation bottlenecks directly in Xcode. Add the flags in the build settings for a target in the <strong>Swift Compiler - Custom Flags</strong> section using the <strong>Other Swift Flags</strong> setting::</p><pre><code>    -Xfrontend -warn-long-function-bodies=&lt;limit&gt;
    -Xfrontend -warn-long-expression-type-checking=&lt;limit&gt;
</code></pre><h3>Xcode Build with Timming</h3><p>Xcode has an option to compile with timming information.</p><p><code>Product -&gt; Perform Action -&gt; Build with Timming Summary</code></p><p>Note: The is also a flag for <code>xcodebuild</code>: <code>-buildWithTimingSummary</code></p><h2>Fixes</h2><p>Identifiying methods that take more time to compile is a first step. Next, we need to try to improve the compilation time. Not always it's easy or possible to improve those times.</p><p>It seems one of the things it takes some significat time to compile is operators overload. Things such as <code>x + y</code> takes quite a time because Swift needs to seach for declarations for all the types because the variables <code>x</code> and <code>y</code> can be <code>Ints</code>, <code>Doubles</code>, <code>Strings</code>, <code>Arrays</code>, etc.</p><p>Most all the issues are multiplication of Floats/CGFloats.</p><h4>Resources:</h4><p>https://useyourloaf.com/blog/slow-swift-compiler-performance/</p><p>https://www.avanderlee.com/optimization/analysing-build-performance-xcode/</p><p>https://irace.me/swift-profiling</p><p>https://www.cocoawithlove.com/blog/2016/07/12/type-checker-issues.html</p></div><span>Tagged with: </span><ul class="tag-list"><li><a href="/tags/article">article</a></li><li><a href="/tags/xcode">xcode</a></li></ul></article></div><footer><p>Generated using <a href="https://github.com/johnsundell/publish">Publish</a></p><p><a href="/feed.rss">RSS feed</a></p></footer></body></html>